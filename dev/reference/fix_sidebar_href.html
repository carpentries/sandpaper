<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="update links from a list of HTML node"><title>Fix the refs for a vector of sidebar nodes — fix_sidebar_href • sandpaper</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fix the refs for a vector of sidebar nodes — fix_sidebar_href"><meta property="og:description" content="update links from a list of HTML node"><meta property="og:image" content="https://carpentries.github.io/sandpaper/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@zkamvar"><meta name="twitter:site" content="@thecarpentries"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sandpaper</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.16.5.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/building-with-renv.html">Building Lessons With A Package Cache</a>
    <a class="dropdown-item" href="../articles/automated-pull-requests.html">Working with Automated Pull Requests</a>
    <a class="dropdown-item" href="../articles/include-child-documents.html">Including Child Documents</a>
    <a class="dropdown-item" href="../articles/translations.html">Translating The Workbench</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/carpentries/sandpaper/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fix the refs for a vector of sidebar nodes</h1>
      <small class="dont-index">Source: <a href="https://github.com/carpentries/sandpaper/blob/HEAD/R/utils-sidebar.R" class="external-link"><code>R/utils-sidebar.R</code></a></small>
      <div class="d-none name"><code>fix_sidebar_href.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>update links from a list of HTML node</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fix_sidebar_href</span><span class="op">(</span></span>
<span>  <span class="va">item</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scheme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  server <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  query <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fragment <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">make_url</span><span class="op">(</span><span class="va">parsed</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">append</span><span class="op">(</span><span class="va">first</span>, sep <span class="op">=</span> <span class="st">"#"</span>, <span class="va">last</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>item</dt>
<dd><p>a text representation of HTML nodes that contain <code>&lt;a&gt;</code> elements.</p></dd>


<dt>path, scheme, server, query, fragment</dt>
<dd><p>character vectors of elements to
replace. This can be a single element vector, which will be recycled or
a vector with the same length as <code>item</code>.</p></dd>


<dt>parsed</dt>
<dd><p>a data frame produced via <a href="http://xml2.r-lib.org/reference/url_parse.html" class="external-link">xml2::url_parse</a></p></dd>


<dt>first</dt>
<dd><p>a character vector</p></dd>


<dt>sep</dt>
<dd><p>a character vector of length 1</p></dd>


<dt>last</dt>
<dd><p>a character vector, same length as <code>first</code> or length 1</p></dd>


<dt>trim</dt>
<dd><p>a logical indicating if the leading and trailing <code>sep</code> should
be trimmed from <code>first</code> and <code>last</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>the text representation of HTML nodes with the <code>href</code> element
modified.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Repeat after me: parsing HTML with regular expressions is bad.
This function uses <code><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">xml2::read_html()</a></code> to parse incoming HTML content to
convert the HTML string into an XML document where we can extract all of
the anchor links, parse them and replace their contents without regex. This
is acheived via <code><a href="http://xml2.r-lib.org/reference/url_parse.html" class="external-link">xml2::url_parse()</a></code> separating the URL into pieces and
updating those pieces for each node.</p>
<p><code>fix_sidebar_href()</code> is useful because The sidebar nodes needs to be
updated for the 404 page so that all links use the published URL.
NOTE: this does not take into account <code>port</code> or <code>user</code>.</p>
<p>The auxilary functions <code>make_url()</code>, <code>append()</code> and <code>prepend()</code> are used to
convert the output of <code><a href="http://xml2.r-lib.org/reference/url_parse.html" class="external-link">xml2::url_parse()</a></code> back to a URL.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"&lt;div id='one'&gt;&lt;div id='one-one'&gt;&lt;a href='index.html'&gt;Index&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"&lt;div id='two'&gt;&lt;div id='two-two'&gt;&lt;a href='two.html'&gt;&lt;em&gt;Two&lt;/em&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"&lt;div id='three'&gt;&lt;div id='three-three'&gt;&lt;a href='three.html'&gt;Three&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"&lt;div id='four'&gt;&lt;div id='four-four'&gt;&lt;a href='four.html'&gt;Four&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"&lt;div id='five'&gt;&lt;div id='five-five'&gt;&lt;a href='five.html'&gt;Five&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">snd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-internal.html" class="external-link">asNamespace</a></span><span class="op">(</span><span class="st">"sandpaper"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Prepend a server to the links</span></span></span>
<span class="r-in"><span><span class="va">snd</span><span class="op">$</span><span class="fu">fix_sidebar_href</span><span class="op">(</span><span class="va">my_links</span>, scheme <span class="op">=</span> <span class="st">"https"</span>, server <span class="op">=</span> <span class="st">"example.com"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "&lt;div id=\"one\"&gt;&lt;div id=\"one-one\"&gt;&lt;a href=\"https://example.com/index.html\"&gt;Index&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "&lt;div id=\"two\"&gt;&lt;div id=\"two-two\"&gt;&lt;a href=\"https://example.com/two.html\"&gt;&lt;em&gt;Two&lt;/em&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "&lt;div id=\"three\"&gt;&lt;div id=\"three-three\"&gt;&lt;a href=\"https://example.com/three.html\"&gt;Three&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "&lt;div id=\"four\"&gt;&lt;div id=\"four-four\"&gt;&lt;a href=\"https://example.com/four.html\"&gt;Four&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "&lt;div id=\"five\"&gt;&lt;div id=\"five-five\"&gt;&lt;a href=\"https://example.com/five.html\"&gt;Five&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"     </span>
<span class="r-in"><span><span class="va">snd</span><span class="op">$</span><span class="fu">fix_sidebar_href</span><span class="op">(</span><span class="va">my_links</span>, server <span class="op">=</span> <span class="st">"https://example.com"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "&lt;div id=\"one\"&gt;&lt;div id=\"one-one\"&gt;&lt;a href=\"https://example.com/index.html\"&gt;Index&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "&lt;div id=\"two\"&gt;&lt;div id=\"two-two\"&gt;&lt;a href=\"https://example.com/two.html\"&gt;&lt;em&gt;Two&lt;/em&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "&lt;div id=\"three\"&gt;&lt;div id=\"three-three\"&gt;&lt;a href=\"https://example.com/three.html\"&gt;Three&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "&lt;div id=\"four\"&gt;&lt;div id=\"four-four\"&gt;&lt;a href=\"https://example.com/four.html\"&gt;Four&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "&lt;div id=\"five\"&gt;&lt;div id=\"five-five\"&gt;&lt;a href=\"https://example.com/five.html\"&gt;Five&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add an anchor to the links</span></span></span>
<span class="r-in"><span><span class="va">snd</span><span class="op">$</span><span class="fu">fix_sidebar_href</span><span class="op">(</span><span class="va">my_links</span>, scheme <span class="op">=</span> <span class="st">"https"</span>, fragment <span class="op">=</span> <span class="st">"anchor"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "&lt;div id=\"one\"&gt;&lt;div id=\"one-one\"&gt;&lt;a href=\"https://index.html#anchor\"&gt;Index&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "&lt;div id=\"two\"&gt;&lt;div id=\"two-two\"&gt;&lt;a href=\"https://two.html#anchor\"&gt;&lt;em&gt;Two&lt;/em&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "&lt;div id=\"three\"&gt;&lt;div id=\"three-three\"&gt;&lt;a href=\"https://three.html#anchor\"&gt;Three&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "&lt;div id=\"four\"&gt;&lt;div id=\"four-four\"&gt;&lt;a href=\"https://four.html#anchor\"&gt;Four&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "&lt;div id=\"five\"&gt;&lt;div id=\"five-five\"&gt;&lt;a href=\"https://five.html#anchor\"&gt;Five&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;"     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># NOTE: this will _always_ return a character vector, even if the input is</span></span></span>
<span class="r-in"><span><span class="co"># incorrect</span></span></span>
<span class="r-in"><span><span class="va">snd</span><span class="op">$</span><span class="fu">fix_sidebar_href</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, server <span class="op">=</span> <span class="st">"example.com"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] ""</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Davey, Erin Becker, Zhian N. Kamvar, Joel H. Nitta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

