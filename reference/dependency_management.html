<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Lesson Runtime Dependency Management — manage_deps • sandpaper</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Lesson Runtime Dependency Management — manage_deps"><meta name="description" content="A customized provisioner for Carpentries Lessons based on
renv that will install and maintain the requirements for the lesson
while respecting user environments. This setup leads to several
advantages:
reliable setup: the version of the lesson built on the carpentries
website will be the same as what you build on your computer because the
packages will be identical
environmentally friendly: The lesson dependencies are NOT stored in
your default R library and they will not alter your R environment.
transparent: any additions or deletions to the cache will be recorded
in the lockfile, which is tracked by git.


The functions that control this cache are the following:
manage_deps(): Creates and updates the dependencies in your lesson.
If no lockfile exists in your lesson, this will create one for you.
update_cache(): fetches updates for the dependencies and applies them
to your cache and lockfile.


This is a wrapper around renv::record(), which helps you record a package
or set of packages in your lockfile. It can be useful when you want to
upgrade or downgrade a specific package."><meta property="og:description" content="A customized provisioner for Carpentries Lessons based on
renv that will install and maintain the requirements for the lesson
while respecting user environments. This setup leads to several
advantages:
reliable setup: the version of the lesson built on the carpentries
website will be the same as what you build on your computer because the
packages will be identical
environmentally friendly: The lesson dependencies are NOT stored in
your default R library and they will not alter your R environment.
transparent: any additions or deletions to the cache will be recorded
in the lockfile, which is tracked by git.


The functions that control this cache are the following:
manage_deps(): Creates and updates the dependencies in your lesson.
If no lockfile exists in your lesson, this will create one for you.
update_cache(): fetches updates for the dependencies and applies them
to your cache and lockfile.


This is a wrapper around renv::record(), which helps you record a package
or set of packages in your lockfile. It can be useful when you want to
upgrade or downgrade a specific package."><meta property="og:image" content="https://carpentries.github.io/sandpaper/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@zkamvar"><meta name="twitter:site" content="@thecarpentries"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sandpaper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.16.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/building-with-renv.html">Building Lessons With A Package Cache</a></li>
    <li><a class="dropdown-item" href="../articles/automated-pull-requests.html">Working with Automated Pull Requests</a></li>
    <li><a class="dropdown-item" href="../articles/include-child-documents.html">Including Child Documents</a></li>
    <li><a class="dropdown-item" href="../articles/translations.html">Translating The Workbench</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/carpentries/sandpaper/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Lesson Runtime Dependency Management</h1>
      <small class="dont-index">Source: <a href="https://github.com/carpentries/sandpaper/blob/main/R/manage_deps.R" class="external-link"><code>R/manage_deps.R</code></a></small>
      <div class="d-none name"><code>dependency_management.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A customized provisioner for Carpentries Lessons based on
<span class="pkg">renv</span> that will install and maintain the requirements for the lesson
while <em>respecting user environments</em>. This setup leads to several
advantages:</p><ul><li><p><strong>reliable setup</strong>: the version of the lesson built on the carpentries
website will be the same as what you build on your computer because the
packages will be identical</p></li>
<li><p><strong>environmentally friendly</strong>: The lesson dependencies are NOT stored in
your default R library and they will not alter your R environment.</p></li>
<li><p><strong>transparent</strong>: any additions or deletions to the cache will be recorded
in the lockfile, which is tracked by git.</p></li>
</ul><p>The functions that control this cache are the following:</p><ol><li><p><code>manage_deps()</code>: Creates and updates the dependencies in your lesson.
If no lockfile exists in your lesson, this will create one for you.</p></li>
<li><p><code>update_cache()</code>: fetches updates for the dependencies and applies them
to your cache and lockfile.</p></li>
</ol><p>This is a wrapper around <code><a href="https://rstudio.github.io/renv/reference/record.html" class="external-link">renv::record()</a></code>, which helps you record a package
or set of packages in your lockfile. It can be useful when you want to
upgrade or downgrade a specific package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">manage_deps</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  profile <span class="op">=</span> <span class="st">"lesson-requirements"</span>,</span>
<span>  snapshot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">update_cache</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  profile <span class="op">=</span> <span class="st">"lesson-requirements"</span>,</span>
<span>  prompt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="op">!</span><span class="va">prompt</span>,</span>
<span>  snapshot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pin_version</span><span class="op">(</span>records <span class="op">=</span> <span class="cn">NULL</span>, profile <span class="op">=</span> <span class="st">"lesson-requirements"</span>, path <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>path to your lesson. Defaults to the current working directory.</p></dd>


<dt id="arg-profile">profile<a class="anchor" aria-label="anchor" href="#arg-profile"></a></dt>
<dd><p>default to the profile for the lesson. Defaults to
<code>lesson-requirements</code>. Only use this if you know what you are doing.</p></dd>


<dt id="arg-snapshot">snapshot<a class="anchor" aria-label="anchor" href="#arg-snapshot"></a></dt>
<dd><p>if <code>TRUE</code>, packages from the cache are added to the lockfile
(default). Setting this to <code>FALSE</code> will add packages to the cache and not
snapshot them.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>if <code>TRUE</code>, output will be suppressed, defaults to <code>FALSE</code>,
providing output about different steps in the process of updating the local
dependencies.</p></dd>


<dt id="arg-prompt">prompt<a class="anchor" aria-label="anchor" href="#arg-prompt"></a></dt>
<dd><p>if <code>TRUE</code>, a message will show you the packages that will be
updated in your lockfile and ask for your permission. This is the default
if it's running in an interactive session.</p></dd>


<dt id="arg-records">records<a class="anchor" aria-label="anchor" href="#arg-records"></a></dt>
<dd><p>a character vector or list of packages/resources to include
in the lockfile. The most common way to do this is to use the
<code>[package]@[version]</code> syntax (e.g. <code>gert@0.1.3</code>), but there are other
specifications where you can specify the remote repository. See
<code><a href="https://rstudio.github.io/renv/reference/record.html" class="external-link">renv::record()</a></code> for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>if <code>snapshot = TRUE</code>, a nested list representing the lockfile will be
returned.</p>
<p>the contents of the lockfile, invisibly</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <span class="pkg">renv</span> package provides a very useful interface to bring one
aspect of reproducibility to R projects. Because people working on
Carpentries lessons are also working academics and will likely have
projects on their computer where the package versions are necessary for
their work, it's important that those environments are respected.</p>
<p>Our flavor of renv applies a package cache explicitly to the content of
the lesson, but does not impose itself as the default renv environment.</p>
<p>This provisioner will do the following steps:</p><ol><li><p>check for consent to use the package cache via <code><a href="package_cache.html">use_package_cache()</a></code>
and prompt for it if needed</p></li>
<li><p>check if the profile has been created and create it if needed via
<code><a href="https://rstudio.github.io/renv/reference/init.html" class="external-link">renv::init()</a></code></p></li>
<li><p>populate the cache with packages needed from the user's system and
download any that are missing via <code><a href="https://rstudio.github.io/renv/reference/hydrate.html" class="external-link">renv::hydrate()</a></code>. This includes all
new packages that have been added to the lesson.</p></li>
<li><p>If there is a lockfile already present, make sure the packages in the
cache are aligned with the lockfile (downloading sources if needed) via
<code><a href="https://rstudio.github.io/renv/reference/restore.html" class="external-link">renv::restore()</a></code>.</p></li>
<li><p>Record the state of the cache in a lockfile tracked by git. This will
include adding new packages and removing old packages. <code><a href="https://rstudio.github.io/renv/reference/snapshot.html" class="external-link">renv::snapshot()</a></code></p></li>
</ol><p>When the lockfile changes, you will see it in git and have the power to
either commit or restore those changes.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="package_cache.html">use_package_cache()</a></code> and <code><a href="package_cache.html">no_package_cache()</a></code> for turning on and
off the package cache, respectively.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Davey, Erin Becker, Zhian N. Kamvar, Joel H. Nitta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

